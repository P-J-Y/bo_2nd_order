% 2020-12-16 07:43 Denton's 4speciesbeam & kperp case
% note: his vdz should be 'sqrt( 2 T_pars / m_s )' not 'sqrt( 2 T_par1 /
% m_1 )', i.e., vdsz need a more sqrt(10)
% 12:14 omega, dn and most dv agree with Denton's jwhamp result, except
% dvz3. If withdn=0 to calculate dvs, can agree. This means that jwhamp may
% incorrect on calculating dvs.

for jpl=1:npl:0
    
    subplot(121); hold on;
    plot(pas,real(wws(:,1,jpl)),'--','Color',...
        pltc(jpl,:),'linewidth',2);
end

%%

% set name for each polarizations
strpola=cell(npola+3+7*S);
strpola(1:19)={ 'Ex', 'Ey', 'Ez', 'Bx', 'By', 'Bz', 'U_E', 'U_B', 'U_E/(U_E+U_B)', ...
  '|Ex|^2/|E|^2', '|Ey|^2/|E|^2', '|Ez|^2/|E|^2', ...
  '|kdotE|^2/(k^2|E|^2)', '|kdotE|^2/(|kdotE|^2+|kcrossE|^2)', ...
  '|Bx|^2/|B|^2', '|By|^2/|B|^2', '|Bz|^2/|B|^2', 'Elliptic','\phi_{maj}'};
strpola((npola-3):(npola+3))={'kx','kz','k','\omega/\omega_n','Jx','Jy','Jz'};
for s=1:S
    snum=['(s=',num2str(s),')'];
    strpola((npola+3+7*(s-1)+1):(npola+3+7*s))={['Jsx',snum], ['Jsy',snum],...
  ['Jsz',snum], ['ns',snum], ['vsx',snum], ['vsy',snum], ['vsz',snum]};
end

% Output of polarization quantities Pola(:,:,:,ipola) for ipola=
% 1 - Ex (complex)
% 2 - Ey (complex)
% 3 - Ez (complex)
% 4 - Bx (complex)
% 5 - By (complex)
% 6 - Bz (complex)
% 7 - UE = electric field energy density (J/m^3)
% 8 - UB = magnetic field energy density (J/m^3)
% 9 - UE/(UE+UB) = fraction of field energy in the electric field
% 10 - |Ex|^2/|E|^2 = fraction of electric field energy in Ex
% 11 - |Ey|^2/|E|^2 = fraction of electric field energy in Ey
% 12 - |Ez|^2/|E|^2 = fraction of electric field energy in Ez
%     = |E_parallel|^2/|E|^2
% 13 - | k dot E |^2 / ( k^2 * |E|^2 ) = a measure of how electrostatic the
%     electric field is
% 14 - | k dot E |^2 / ( | k dot E |^2 + | k cross E |^2 ) = another measure
%     of how electrostatic the electric field is
% 15 - |Bx|^2/|B|^2 = fraction of magnetic field energy in Bx
% 16 - |By|^2/|B|^2 = fraction of magnetic field energy in By
% 17 - |Bz|^2/|B|^2 = fraction of magnetic field energy in Bz
%     = |B_parallel|^2/|B|^2
% 18 - Magnetic ellipticity = -1/0/1 for left-hand polarized, linear
%     polarized, or right hand polarized waves (to do)
% 19 - phimaj = Angle of major axis of the magnetic ellipse (to do)
% npola-3 - kx
% npola-2 - kz
% npola-1 - k
% npola - frequency (complex)
% npola+1 - Jx
% npola+2 - Jy
% npola+3 - Jz
% npola+3+7*(s-1)+1:7 - Jsx, Jsy, Jsz, ns, vsx, vsy, vsz

close all;
h=figure('unit','normalized','Position',[0.01 0.05 0.8 0.8],...
  'DefaultAxesFontSize',15);


jpl=1;
pkzz=Pola(:,:,jpl,npola-2)/kn;
s=1;
% jjpola=[npola,1,2,3,npola+1,npola+2,npola+3,(npola+3+7*(s-1)+1):(npola+3+7*s)];

% jjpola=[npola,(npola+3+7*(s-1)+5):(npola+3+7*s-1),...
%     (npola+3+7*(2-1)+5):(npola+3+7*2-1),(npola+3+7*(3-1)+5):(npola+3+7*3-1),...
%     (npola+3+7*(4-1)+5):(npola+3+7*4-1)];
jjpola=[npola,(npola+3+7*(s-1)+4):(npola+3+7*s-0),...
    (npola+3+7*(2-1)+4):(npola+3+7*2-0),(npola+3+7*(3-1)+4):(npola+3+7*3-0),...
    (npola+3+7*(4-1)+4):(npola+3+7*4-0),1:3];

for jj=1:min(length(jjpola),20)
    
    subplot(4,5,jj);
    if(jjpola(jj)==npola)
      plot(pkzz,real(Pola(:,:,jpl,jjpola(jj))./wn),...
        pkzz,imag(Pola(:,:,jpl,jjpola(jj))./wn),'--','linewidth',2);
%         title(['vdsz/c=',num2str(vdsz/sqrt(c2),3)]);
    else
%       plot(pkzz,real(Pola(:,:,jpl,jjpola(jj))./Pola(:,:,jpl,(npola+3+7*(1-1)+5))),...
%         pkzz,imag(Pola(:,:,jpl,jjpola(jj))./Pola(:,:,jpl,(npola+3+7*(1-1)+5))),'--','linewidth',2);
      plot(pkzz,real(Pola(:,:,jpl,jjpola(jj))),...
        pkzz,imag(Pola(:,:,jpl,jjpola(jj))),'--','linewidth',2);
    end
    grid on;
    xlabel('k/k_n');
    ylabel(strpola{jjpola(jj)});
%     xlim([0.1,5]);
end

%%
%  kperp*rho_par1  kpar*rho_par1 omega/Omega_c1                  Vgroup_x       Vgroup_z       |Vgroup|         S_x            S_z          S            Refract.-Indx.                 Dielec.-Tens. 11               12                            13                            22                            23                            33                            E_x (mV)                      E_y (mV)                      E_z (mV)                      B_x (nT)                      B_y (nT)                      B_z (nT)                      |B| (nT)      u_tot (J/m^3)   u_E/u_tot      u_B/u_tot    |E|^2/(c|B|)^2   |Ex|^2/|E|^2   |Ey|^2/|E|^2   |Ez|^2/|E|^2   |Ek|^2/|E|^2   |Bx|^2/|B|^2   |By|^2/|B|^2   |Bz|^2/|B|^2    B-phi_major  B-ellipticity
dentonf=[ 0.5000000E-01  0.2000000      0.3455390      0.1911505E-01  0.4637134       1.345661       1.423318      0.4122170E-01  0.1420495E-01  0.1342993E-01   81.74559      -4.522127      -2969.092       2196.580      -3782.184      -10860.81       3560.774       74.73834      -5837.378       3610.956      -9877.866      -26817.40       827294.8       232231.7      0.7683493       0.000000     -0.2312975E-01  0.6393879      0.1328977E-01 -0.1052863E-01 -0.3238112E-02 -0.1694774      0.2024130     -0.1049897E-01  0.8095281E-03  0.4236934E-01  0.2676007      0.8650302E-13  0.2558928E-04  0.1646923      0.1553763E-03  0.5903607      0.4093518      0.2874699E-03  0.3980292E-01  0.4012429      0.5736794      0.2507768E-01  -84.84157      0.8338066    
  0.5000000E-01  0.1800000      0.3176790      0.3042034E-01  0.4520530       1.463280       1.531515      0.6729373E-01  0.2078915E-01  0.1986290E-01   80.08552      -7.668837      -4253.759       5901.938      -8203.667      -11850.38       3840.222       61.26142      -7272.929       7732.558      -12647.51      -29503.58       1052878.       279605.7      0.7619580       0.000000     -0.5450763E-03  0.6474396      0.1137224E-01 -0.1060266E-01 -0.1581731E-01 -0.1666584      0.1953805     -0.1794425E-01  0.4393697E-02  0.4629401E-01  0.2620748      0.1007347E-12  0.2197406E-04  0.1356443      0.1619977E-03  0.5805799      0.4191783      0.2417443E-03  0.4628239E-01  0.4080361      0.5604796      0.3148427E-01   89.45376      0.8532114    
  0.5000000E-01  0.1600000      0.2858657      0.4523203E-01  0.4429193       1.750444       1.805612      0.1021225      0.2584031E-01  0.2505081E-01   78.62233      -12.44028      -2361.505       13885.80      -17291.61      -9547.093       4261.902       48.22198      -5416.607       16428.43      -17562.06      -32244.20       1379727.       352449.9      0.7500662       0.000000      0.2695621E-01  0.6606588      0.9020464E-02 -0.1107243E-01 -0.3291458E-01 -0.1643071      0.1871865     -0.2873037E-01  0.1028581E-01  0.5134596E-01  0.2582375      0.1215730E-12  0.1820757E-04  0.1091268      0.1668479E-03  0.5625994      0.4371967      0.2039675E-03  0.5409164E-01  0.4210769      0.5378023      0.4112079E-01   79.84441      0.8776227    
  0.5000000E-01  0.1400000      0.2463802      0.6209496E-01  0.3935556       2.226475       2.260990      0.1577794      0.2788935E-01  0.2746361E-01   77.97208      -19.65122       8562.325       16608.09      -21697.82       2040.358       4895.029       13.78000       5731.074       20390.19      -26536.19      -34795.93       1871533.       468884.7      0.7445064       0.000000      0.5933763E-01  0.6648447      0.5938064E-02 -0.1164210E-01 -0.5557512E-01 -0.1591806      0.1820926     -0.4480952E-01  0.1984826E-01  0.5685020E-01  0.2592654      0.1525770E-12  0.1450776E-04  0.8764564E-01  0.1655274E-03  0.5542897      0.4455395      0.1707992E-03  0.6565452E-01  0.4229047      0.5231534      0.5394192E-01   69.22082      0.8671277    
  0.5000000E-01  0.1200000      0.1960832      0.7784319E-01  0.2354280       2.804977       2.814839      0.3306455      0.2775181E-01  0.2765458E-01   78.71143      -31.24770       12793.70       10292.08      -17911.89       7661.075       5897.443      -118.4039       11038.90       16192.56      -43023.40      -35118.20       2664700.       654269.1      0.7609471       0.000000      0.7894824E-01  0.6438873      0.2185438E-02 -0.1144444E-01 -0.8108417E-01 -0.1484545      0.1846587     -0.7196995E-01  0.3378507E-01  0.6185604E-01  0.2699250      0.2003607E-12  0.1104782E-04  0.7234419E-01  0.1527120E-03  0.5790405      0.4208237      0.1357513E-03  0.8695338E-01  0.3927200      0.5390994      0.6818056E-01   70.59627      0.8151454    
  0.5000000E-01  0.1000000      0.1348284      0.8789702E-01  0.3001682E-01   3.293366       3.293502       2.928258      0.2668912E-01  0.2668801E-01   79.97489      -52.13703       11421.30       7375.686      -18601.54       9740.633       7466.984      -709.8676       13596.43       16012.63      -70952.43      -24347.45       4086318.       920945.4      0.7901588       0.000000      0.3726921E-01  0.6116880     -0.9542919E-03 -0.9847081E-02 -0.1040408     -0.1401540      0.1894148     -0.1218088      0.5202038E-01  0.7007701E-01  0.2979931      0.2763445E-12  0.8010110E-05  0.6392809E-01  0.1252988E-03  0.6243509      0.3755512      0.9787567E-04  0.1243453      0.3431043      0.5711196      0.8577609E-01   82.70582      0.7682334    
  0.5000000E-01  0.8000000E-01  0.6643020E-01  0.8470971E-01 -0.1626914       3.417874       3.421743     -0.5206773      0.2478433E-01  0.2475630E-01   74.32237      -94.77356       10862.02       8816.106      -23256.72       19159.49       9218.148      -2943.258       22862.29       15081.59      -99527.77       21725.65       6989713.       1143005.      0.7937955       0.000000     -0.4776879E-01  0.6062544     -0.3254374E-02 -0.7192723E-02 -0.1524812     -0.1402584      0.1685120     -0.2123994      0.9530072E-01  0.8766148E-01  0.3649651      0.3969135E-12  0.5576908E-05  0.6676315E-01  0.8353272E-04  0.6301114      0.3698263      0.6232621E-04  0.1747203      0.3222453      0.5518776      0.1258771      -82.50346      0.7565569    
  0.5000000E-01  0.6000000E-01  0.1171275E-01  0.6066693E-01 -0.1974818       1.540313       1.552921     -0.3072026      0.3938610E-01  0.3906633E-01   32.93214      -170.5741       20259.06       10503.44      -16125.46       46158.02       4751.424      -6140.165       29488.44       2973.303      -55459.02       80901.81      0.1369208E+08   675929.3      0.7691949       0.000000     -0.6463155E-01  0.6357262     -0.3091596E-02 -0.2146057E-02 -0.2724203     -0.8189857E-01  0.6591065E-01 -0.3371886      0.2270169      0.6824881E-01  0.5051288      0.4688525E-12  0.4721207E-05  0.1082675      0.4360686E-04  0.5916608      0.4083251      0.1416353E-04  0.2401532      0.3171412      0.4626218      0.2202370      -76.25230      0.8077412   ];

%   kperp*rhopar1   kpar*rhopar1 omega/Omega_c1                dDen (cm^{-3})                   dV_x (km/s)                   dV_y (km/s)                   dV_z (km/s)                   |dV| (km/s)    u_Ksp/u_tot |dVx|^2/|dV|^2 |dVy|^2/|dV|^2 |dVz|^2/|dV|^2 |dVk|^2/|dV|^2 Compressibilty   Alfven-Ratio Par-Phase-Rat.
dentons1=[0.5000000E-01  0.2000000      0.3455390      0.1911505E-01  0.5016715E-03  0.6875334E-03 -0.6864593E-01   5.204033      -7.033089      0.3137301       1.765691       1.396569       9.039774      0.3950171      0.3314672      0.6065134      0.6201938E-01  0.1190244      0.1011556       3.387138      0.1296848    
  0.5000000E-01  0.1800000      0.3176790      0.3042034E-01  0.5611749E-03  0.6538535E-03  0.2472071       5.317126      -6.989248      0.3799779       1.852049       1.249017       9.072874      0.3416983      0.3441928      0.5951863      0.6062084E-01  0.1254131      0.1080966       3.557391      0.1449632    
  0.5000000E-01  0.1600000      0.2858657      0.4523203E-01  0.6594795E-03  0.5876931E-03  0.6373891       5.529532      -6.864414      0.4928287       2.010150      0.9710122       9.128451      0.2866085      0.3718049      0.5683889      0.5980622E-01  0.1330078      0.1170095       3.708924      0.1620207    
  0.5000000E-01  0.1400000      0.2463802      0.6209496E-01  0.7931258E-03  0.4539010E-03   1.104487       5.698947      -6.806523      0.6547424       2.212906      0.4762275       9.250896      0.2345366      0.3937632      0.5463653      0.5987147E-01  0.1358241      0.1242327       3.778945      0.1753588    
  0.5000000E-01  0.1200000      0.1960832      0.7784319E-01  0.9112828E-03  0.2205267E-03   1.494977       5.665028      -7.009847      0.8503076       2.315246     -0.2834530       9.467269      0.1870548      0.3829947      0.5563029      0.6070243E-01  0.1230782      0.1206526       3.651368      0.1755532    
  0.5000000E-01  0.1000000      0.1348284      0.8789702E-01  0.9397878E-03 -0.5678480E-04   1.326733       5.586995      -7.443612       1.071839       2.211499      -1.157475       9.785775      0.1449011      0.3443426      0.5905949      0.6506249E-01  0.9140569E-01  0.9982282E-01   3.200887      0.1600679    
  0.5000000E-01  0.8000000E-01  0.6643020E-01  0.8470971E-01  0.8320480E-03 -0.3878986E-03  0.6888082       5.834663      -7.675861       1.247177       1.974248      -2.426596       10.23612      0.1103841      0.3294368      0.5771656      0.9339760E-01  0.4990429E-01  0.6327120E-01   2.334856      0.1351781    
  0.5000000E-01  0.6000000E-01  0.1171275E-01  0.6066693E-01  0.1870975E-03 -0.4981700E-03  0.4791511       6.271334      -7.503448       1.014670      0.7799605      -5.025445       11.07944      0.1094791      0.3222644      0.4670423      0.2106933      0.6879360E-02  0.1109830E-01   1.427984      0.3152801E-01
        ];

%   kperp*rhopar1   kpar*rhopar1 omega/Omega_c1                dDen (cm^{-3})                   dV_x (km/s)                   dV_y (km/s)                   dV_z (km/s)                   |dV| (km/s)    u_Ksp/u_tot |dVx|^2/|dV|^2 |dVy|^2/|dV|^2 |dVz|^2/|dV|^2 |dVk|^2/|dV|^2 Compressibilty   Alfven-Ratio Par-Phase-Rat.
dentons2=[0.5000000E-01  0.2000000      0.3455390      0.1911505E-01  0.5169995E-03  0.7117918E-03 -0.2313798       6.395388      -7.649647     -0.2717146E-01   1.680615      0.9167041       10.15565      0.3013996E-03  0.3970879      0.5673787      0.3553340E-01  0.8177693E-01  0.8771718E-01   4.274969      0.1298825    
  0.5000000E-01  0.1800000      0.3176790      0.3042034E-01  0.5840603E-03  0.6810650E-03 -0.5577087E-02   6.475765      -7.587193     -0.3067140E-01   1.802310      0.7590789       10.16497      0.2592935E-03  0.4058548      0.5571313      0.3701396E-01  0.8792158E-01  0.9512322E-01   4.465332      0.1450038    
  0.5000000E-01  0.1600000      0.2858657      0.4523203E-01  0.6946632E-03  0.6162797E-03  0.2693789       6.607795      -7.471436     -0.3639284E-01   2.013938      0.4865881       10.19078      0.2159414E-03  0.4211335      0.5375315      0.4133495E-01  0.9572789E-01  0.1049550       4.622408      0.1617490    
  0.5000000E-01  0.1400000      0.2463802      0.6209496E-01  0.8464749E-03  0.4801460E-03  0.5931270       6.649475      -7.422512     -0.4419425E-01   2.298888      0.2522211E-01   10.24444      0.1738785E-03  0.4246590      0.5249779      0.5036303E-01  0.1019470      0.1143516       4.634247      0.1747753    
  0.5000000E-01  0.1200000      0.1960832      0.7784319E-01  0.9852398E-03  0.2387605E-03  0.7891620       6.439705      -7.598699     -0.5136488E-01   2.532559     -0.6591230       10.32878      0.1345998E-03  0.3945547      0.5412527      0.6419253E-01  0.9811416E-01  0.1144817       4.346147      0.1756156    
  0.5000000E-01  0.1000000      0.1348284      0.8789702E-01  0.1032104E-02 -0.4165417E-04  0.3723144       6.117471      -7.904202     -0.5410213E-01   2.622431      -1.385151       10.43251      0.9956007E-04  0.3451216      0.5740624      0.8081600E-01  0.7856912E-01  0.9752035E-01   3.637953      0.1649440    
  0.5000000E-01  0.8000000E-01  0.6643020E-01  0.8470971E-01  0.9655879E-03 -0.3582140E-03 -0.4780545       6.062836      -7.955393     -0.5157249E-01   2.621483      -2.363564       10.61772      0.7180021E-04  0.3280806      0.5614081      0.1105113      0.4737770E-01  0.6463008E-01   2.512191      0.1612763    
  0.5000000E-01  0.6000000E-01  0.1171275E-01  0.6066693E-01  0.4614100E-03 -0.4881901E-03 -0.6465696       6.357311      -7.715405     -0.2823149E-01   1.686661      -4.567702       11.13869      0.6689457E-04  0.3291151      0.4797941      0.1910909      0.8802481E-02  0.1435313E-01   1.443299      0.2105121       ];
%   kperp*rhopar1   kpar*rhopar1 omega/Omega_c1                dDen (cm^{-3})                   dV_x (km/s)                   dV_y (km/s)                   dV_z (km/s)                   |dV| (km/s)    u_Ksp/u_tot |dVx|^2/|dV|^2 |dVy|^2/|dV|^2 |dVz|^2/|dV|^2 |dVk|^2/|dV|^2 Compressibilty   Alfven-Ratio Par-Phase-Rat.
dentons3=[0.5000000E-01  0.2000000      0.3455390      0.1911505E-01  0.6996009E-05 -0.7678759E-05  -30.04566       55.94798      -53.35008      -30.17335       10.31004      -16.73695       90.42126      0.3952227      0.4932628      0.4594742      0.4726300E-01  0.1772137E-02  0.1506874       338.8901     -0.1150014    
  0.5000000E-01  0.1800000      0.3176790      0.3042034E-01  0.1008162E-04 -0.8649608E-05  -42.08581       61.83557      -59.37222      -41.69393       15.89354      -20.13689       107.3145      0.4780459      0.4858163      0.4570392      0.5714455E-01  0.2130529E-02  0.2569113       497.6895     -0.1022977    
  0.5000000E-01  0.1600000      0.2858657      0.4523203E-01  0.1446073E-04 -0.9117702E-05  -58.85196       65.99391      -63.84177      -57.72511       24.59364      -23.28667       127.9602      0.5631771      0.4775151      0.4524269      0.7005791E-01  0.2535181E-02  0.4382370       728.7925     -0.7235438E-01
  0.5000000E-01  0.1400000      0.2463802      0.6209496E-01  0.2037681E-04 -0.8672304E-05  -80.78051       66.86152      -64.60360      -78.73862       37.51765      -25.23777       153.0159      0.6416766      0.4696342      0.4430449      0.8732085E-01  0.2915526E-02  0.7295947       1033.894     -0.1542752E-01
  0.5000000E-01  0.1200000      0.1960832      0.7784319E-01  0.2815442E-04 -0.6778365E-05  -108.1986       62.34258      -58.80158      -105.8382       56.08488      -24.40713       184.3749      0.7094525      0.4587129      0.4312322      0.1100550      0.3095764E-02   1.151006       1384.873      0.6804843E-01
  0.5000000E-01  0.1000000      0.1348284      0.8789702E-01  0.3815520E-04 -0.1889832E-05  -140.8709       46.28152      -41.47102      -140.7107       82.02761      -16.37622       224.7279      0.7641796      0.4353552      0.4261033      0.1385414      0.2853507E-02   1.643460       1688.084      0.1627219    
  0.5000000E-01  0.8000000E-01  0.6643020E-01  0.8470971E-01  0.5119867E-04  0.5530202E-05  -173.2649       19.77802      -17.56204      -177.3477       116.2926      0.4750793       275.1304      0.7974684      0.4017598      0.4195772      0.1786630      0.2173589E-02   1.990914       1686.813      0.2854069    
  0.5000000E-01  0.6000000E-01  0.1171275E-01  0.6066693E-01  0.6541915E-04  0.3870246E-05  -174.1624       12.92508      -16.14612      -178.3983       147.0688       3.832887       290.2243      0.7512134      0.3620983      0.3809401      0.2569616      0.1520486E-02   1.683150       979.8406      0.4566188    ];
%   kperp*rhopar1   kpar*rhopar1 omega/Omega_c1                dDen (cm^{-3})                   dV_x (km/s)                   dV_y (km/s)                   dV_z (km/s)                   |dV| (km/s)    u_Ksp/u_tot |dVx|^2/|dV|^2 |dVy|^2/|dV|^2 |dVz|^2/|dV|^2 |dVk|^2/|dV|^2 Compressibilty   Alfven-Ratio Par-Phase-Rat.
dentons4=[0.5000000E-01  0.2000000      0.3455390      0.1911505E-01  0.8332450E-05  0.3194720E-04  0.6643765       4.520221      -1.386726     -0.5718457      0.8149912E-01  0.9216270E-01   4.810296      0.4474086E-01  0.9021065      0.9723934E-01  0.6541383E-03  0.6325446E-01  0.1522206E-01  0.9590944      0.1539686    
  0.5000000E-01  0.1800000      0.3176790      0.3042034E-01  0.1280430E-04  0.3587089E-04  0.9695786       4.852348      -1.337243     -0.6402376      0.9162820E-01  0.8129006E-01   5.167058      0.4433020E-01  0.9171067      0.8233133E-01  0.5619719E-03  0.7555317E-01  0.2112120E-01   1.153795      0.1719993    
  0.5000000E-01  0.1600000      0.2858657      0.4523203E-01  0.2072339E-04  0.3771380E-04   1.498020       4.916749      -1.608046     -0.8214080      0.1073588      0.6225345E-01   5.449258      0.4085353E-01  0.8896787      0.1098026      0.5186635E-03  0.8857851E-01  0.2776854E-01   1.321687      0.1934391    
  0.5000000E-01  0.1400000      0.2463802      0.6209496E-01  0.3297274E-04  0.3492655E-04   2.247561       4.570978      -2.381333      -1.078849      0.1258086      0.2845973E-01   5.726838      0.3595281E-01  0.7910978      0.2083949      0.5073002E-03  0.9791504E-01  0.3432185E-01   1.448214      0.2119995    
  0.5000000E-01  0.1200000      0.1960832      0.7784319E-01  0.4580287E-04  0.2502152E-04   2.744683       3.761021      -3.804850     -0.9817268      0.1358006     -0.2603475E-01   6.094124      0.3100288E-01  0.5837244      0.4157608      0.5148211E-03  0.9204264E-01  0.3738675E-01   1.512965      0.2197059    
  0.5000000E-01  0.1000000      0.1348284      0.8789702E-01  0.5416117E-04  0.1703003E-04   2.293748       3.272627      -5.330500     -0.8632228E-01  0.1204066     -0.9592116E-01   6.664589      0.2688363E-01  0.3595798      0.6398867      0.5335514E-03  0.7166320E-01  0.3630020E-01   1.484659      0.2370689    
  0.5000000E-01  0.8000000E-01  0.6643020E-01  0.8470971E-01  0.8234135E-04  0.2416401E-04   1.423354       4.031263      -6.384899      0.9881687      0.4440514E-01 -0.1783239       7.749465      0.2530694E-01  0.3043421      0.6950956      0.5623457E-03  0.7607988E-01  0.5528548E-01   1.338237      0.3181915    
  0.5000000E-01  0.6000000E-01  0.1171275E-01  0.6066693E-01  0.2088934E-03  0.6118979E-05   1.032306       5.697296      -7.174790       1.335204     -0.1051661     -0.1111213       9.317114      0.3096839E-01  0.3861925      0.6135379      0.2696489E-03  0.1500312      0.1711660       1.009836      0.4531872    ];


dentonkz=dentons1(:,2);
dentonw=dentons1(:,3)+1i*dentons1(:,4);

dentonfEx=(dentonf(:,25)+1i*dentonf(:,26))*1e0;
dentonfEy=(dentonf(:,27)+1i*dentonf(:,28))*1e0;
dentonfEz=(dentonf(:,29)+1i*dentonf(:,30))*1e0;

dentons1dn=(dentons1(:,5)+1i*dentons1(:,6))*1e3;
dentons1dvx=dentons1(:,7)+1i*dentons1(:,8);
dentons1dvy=dentons1(:,9)+1i*dentons1(:,10);
dentons1dvz=dentons1(:,11)+1i*dentons1(:,12);
dentons2dn=(dentons2(:,5)+1i*dentons2(:,6))*1e3;
dentons2dvx=dentons2(:,7)+1i*dentons2(:,8);
dentons2dvy=dentons2(:,9)+1i*dentons2(:,10);
dentons2dvz=dentons2(:,11)+1i*dentons2(:,12);
dentons3dn=(dentons3(:,5)+1i*dentons3(:,6))*1e3;
dentons3dvx=dentons3(:,7)+1i*dentons3(:,8);
dentons3dvy=dentons3(:,9)+1i*dentons3(:,10);
dentons3dvz=dentons3(:,11)+1i*dentons3(:,12);
dentons4dn=(dentons4(:,5)+1i*dentons4(:,6))*1e3;
dentons4dvx=dentons4(:,7)+1i*dentons4(:,8);
dentons4dvy=dentons4(:,9)+1i*dentons4(:,10);
dentons4dvz=dentons4(:,11)+1i*dentons4(:,12);

dentons1dvx0=dentons1dvx;
% dentonnorm=dentons1dvx0;
dentonnorm=1e-6*sqrt(1);

dentons1dn=dentons1dn./dentonnorm;
dentons1dvy=dentons1dvy./dentonnorm;
dentons1dvz=dentons1dvz./dentonnorm;
dentons1dvx=dentons1dvx./dentonnorm;
dentons2dn=dentons2dn./dentonnorm;
dentons2dvy=dentons2dvy./dentonnorm;
dentons2dvz=dentons2dvz./dentonnorm;
dentons2dvx=dentons2dvx./dentonnorm;
dentons3dn=dentons3dn./dentonnorm;
dentons3dvy=dentons3dvy./dentonnorm;
dentons3dvz=dentons3dvz./dentonnorm;
dentons3dvx=dentons3dvx./dentonnorm;
dentons4dn=dentons4dn./dentonnorm;
dentons4dvy=dentons4dvy./dentonnorm;
dentons4dvz=dentons4dvz./dentonnorm;
dentons4dvx=dentons4dvx./dentonnorm;

subplot(4,5,1);hold on;
plot(dentonkz,real(dentonw),'x',dentonkz,imag(dentonw),'+');

subplot(4,5,2);hold on;
plot(dentonkz,real(dentons1dn),'x',dentonkz,imag(dentons1dn),'+');

subplot(4,5,3);hold on;
plot(dentonkz,real(dentons1dvx),'x',dentonkz,imag(dentons1dvx),'+');

subplot(4,5,4);hold on;
plot(dentonkz,real(dentons1dvy),'x',dentonkz,imag(dentons1dvy),'+');

subplot(4,5,5);hold on;
plot(dentonkz,real(dentons1dvz),'x',dentonkz,imag(dentons1dvz),'+');
legend('BO Re','BO Im','WHAMP Re','WHAMP Im','location','best');legend('boxoff');

subplot(4,5,6);hold on;
plot(dentonkz,real(dentons2dn),'x',dentonkz,imag(dentons2dn),'+');

subplot(4,5,7);hold on;
plot(dentonkz,real(dentons2dvx),'x',dentonkz,imag(dentons2dvx),'+');

subplot(4,5,8);hold on;
plot(dentonkz,real(dentons2dvy),'x',dentonkz,imag(dentons2dvy),'+');

subplot(4,5,9);hold on;
plot(dentonkz,real(dentons2dvz),'x',dentonkz,imag(dentons2dvz),'+');

subplot(4,5,10);hold on;
plot(dentonkz,real(dentons3dn),'x',dentonkz,imag(dentons3dn),'+');

subplot(4,5,11);hold on;
plot(dentonkz,real(dentons3dvx),'x',dentonkz,imag(dentons3dvx),'+');

subplot(4,5,12);hold on;
plot(dentonkz,real(dentons3dvy),'x',dentonkz,imag(dentons3dvy),'+');

subplot(4,5,13);hold on;
plot(dentonkz,real(dentons3dvz),'x',dentonkz,imag(dentons3dvz),'+');
title(['withdn=',num2str(withdn)]);

subplot(4,5,14);hold on;
plot(dentonkz,real(dentons4dn),'x',dentonkz,imag(dentons4dn),'+');

subplot(4,5,15);hold on;
plot(dentonkz,real(dentons4dvx),'x',dentonkz,imag(dentons4dvx),'+');

subplot(4,5,16);hold on;
plot(dentonkz,real(dentons4dvy),'x',dentonkz,imag(dentons4dvy),'+');

subplot(4,5,17);hold on;
plot(dentonkz,real(dentons4dvz),'x',dentonkz,imag(dentons4dvz),'+');

subplot(4,5,18);hold on;
plot(dentonkz,real(dentonfEx),'x',dentonkz,imag(dentonfEx),'+');

subplot(4,5,19);hold on;
plot(dentonkz,real(dentonfEy),'x',dentonkz,imag(dentonfEy),'+');

subplot(4,5,20);hold on;
plot(dentonkz,real(dentonfEz),'x',dentonkz,imag(dentonfEz),'+');


set(gcf,'Units','inches');
screenposition = get(gcf,'Position');
set(gcf,'PaperPosition',[0 0 screenposition(3:4)],...
  'PaperSize',[screenposition(3:4)]);

print(gcf,'-dpdf',['bo_jwhamp_withdn=',num2str(withdn),'.pdf']);

