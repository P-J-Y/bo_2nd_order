% Hua-sheng XIE, 2018-10-28 22:41 beam with kperp=0.5
% datpdrk=[kzz*cwp,wws(:,1,1),wws(:,1,2)]
datpdrk =[
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.7774 + 0.0000i
   0.0100 + 0.0000i   0.0044 + 0.0046i   0.7900 - 0.0022i
   0.0200 + 0.0000i   0.0089 + 0.0093i   0.7915 - 0.0291i
   0.0300 + 0.0000i   0.0134 + 0.0142i   0.7740 - 0.0368i
   0.0400 + 0.0000i   0.0180 + 0.0193i   0.7639 - 0.0334i
   0.0500 + 0.0000i   0.0228 + 0.0249i   0.7597 - 0.0285i
   0.0600 + 0.0000i   0.0278 + 0.0311i   0.7591 - 0.0247i
   0.0700 + 0.0000i   0.0331 + 0.0379i   0.7610 - 0.0230i
   0.0800 + 0.0000i   0.0391 + 0.0456i   0.7644 - 0.0244i
   0.0900 + 0.0000i   0.0462 + 0.0544i   0.7668 - 0.0298i
   0.1000 + 0.0000i   0.0553 + 0.0636i   0.7654 - 0.0389i
   0.1100 + 0.0000i   0.0665 + 0.0721i   0.7580 - 0.0499i
   0.1200 + 0.0000i   0.0795 + 0.0794i   0.7444 - 0.0585i
   0.1300 + 0.0000i   0.0935 + 0.0850i   0.7284 - 0.0603i
   0.1400 + 0.0000i   0.1080 + 0.0890i   0.7164 - 0.0560i
   0.1500 + 0.0000i   0.1227 + 0.0918i   0.7106 - 0.0503i
   0.1600 + 0.0000i   0.1373 + 0.0934i   0.7092 - 0.0459i
   0.1700 + 0.0000i   0.1515 + 0.0941i   0.7106 - 0.0432i
   0.1800 + 0.0000i   0.1654 + 0.0941i   0.7138 - 0.0419i
   0.1900 + 0.0000i   0.1788 + 0.0935i   0.7183 - 0.0417i
   0.2000 + 0.0000i   0.1916 + 0.0925i   0.7237 - 0.0423i
   0.2100 + 0.0000i   0.2039 + 0.0911i   0.7298 - 0.0433i
   0.2200 + 0.0000i   0.2156 + 0.0896i   0.7365 - 0.0446i
   0.2300 + 0.0000i   0.2268 + 0.0878i   0.7436 - 0.0460i
   0.2400 + 0.0000i   0.2375 + 0.0858i   0.7512 - 0.0474i
   0.2500 + 0.0000i   0.2477 + 0.0837i   0.7593 - 0.0487i
   0.2600 + 0.0000i   0.2574 + 0.0813i   0.7676 - 0.0499i
   0.2700 + 0.0000i   0.2667 + 0.0787i   0.7764 - 0.0510i
   0.2800 + 0.0000i   0.2756 + 0.0758i   0.7855 - 0.0518i
   0.2900 + 0.0000i   0.2840 + 0.0725i   0.7948 - 0.0524i
   0.3000 + 0.0000i   0.2921 + 0.0687i   0.8045 - 0.0528i
   0.3100 + 0.0000i   0.2998 + 0.0644i   0.8143 - 0.0530i
   0.3200 + 0.0000i   0.3071 + 0.0595i   0.8245 - 0.0529i
   0.3300 + 0.0000i   0.3141 + 0.0540i   0.8348 - 0.0527i
   0.3400 + 0.0000i   0.3208 + 0.0478i   0.8454 - 0.0522i
   0.3500 + 0.0000i   0.3270 + 0.0409i   0.8562 - 0.0514i
   0.3600 + 0.0000i   0.3329 + 0.0332i   0.8672 - 0.0505i
   0.3700 + 0.0000i   0.3384 + 0.0248i   0.8784 - 0.0493i
   0.3800 + 0.0000i   0.3434 + 0.0157i   0.8899 - 0.0479i
   0.3900 + 0.0000i   0.3479 + 0.0058i   0.9015 - 0.0463i
   0.4000 + 0.0000i   0.3518 - 0.0048i   0.9134 - 0.0446i
   0.4100 + 0.0000i   0.3551 - 0.0161i   0.9256 - 0.0426i
   0.4200 + 0.0000i   0.3577 - 0.0281i   0.9380 - 0.0405i
   0.4300 + 0.0000i   0.3594 - 0.0406i   0.9506 - 0.0382i
   0.4400 + 0.0000i   0.3603 - 0.0536i   0.9636 - 0.0358i
   0.4500 + 0.0000i   0.3601 - 0.0670i   0.9768 - 0.0333i
   0.4600 + 0.0000i   0.3588 - 0.0804i   0.9903 - 0.0307i
   0.4700 + 0.0000i   0.3565 - 0.0938i   1.0042 - 0.0281i
   0.4800 + 0.0000i   0.3531 - 0.1068i   1.0183 - 0.0254i
   0.4900 + 0.0000i   0.3488 - 0.1193i   1.0327 - 0.0226i
   0.5000 + 0.0000i   0.3439 - 0.1310i   1.0474 - 0.0199i
   0.5100 + 0.0000i   0.3385 - 0.1420i   1.0624 - 0.0171i
   0.5200 + 0.0000i   0.3328 - 0.1523i   1.0777 - 0.0144i
   0.5300 + 0.0000i   0.3270 - 0.1617i   1.0932 - 0.0116i
   0.5400 + 0.0000i   0.3212 - 0.1705i   1.1090 - 0.0090i
   0.5500 + 0.0000i   0.3156 - 0.1787i   1.1251 - 0.0064i
   0.5600 + 0.0000i   0.3102 - 0.1864i   1.1414 - 0.0038i
   0.5700 + 0.0000i   0.3050 - 0.1937i   1.1580 - 0.0013i
   0.5800 + 0.0000i   0.3001 - 0.2006i   1.1748 + 0.0011i
   0.5900 + 0.0000i   0.2954 - 0.2073i   1.1918 + 0.0034i
   0.6000 + 0.0000i   0.2911 - 0.2136i   1.2090 + 0.0057i
   0.6100 + 0.0000i   0.2870 - 0.2199i   1.2264 + 0.0078i
   0.6200 + 0.0000i   0.2832 - 0.2259i   1.2440 + 0.0099i
   0.6300 + 0.0000i   0.2797 - 0.2319i   1.2618 + 0.0119i
   0.6400 + 0.0000i   0.2764 - 0.2378i   1.2798 + 0.0139i
   0.6500 + 0.0000i   0.2734 - 0.2437i   1.2979 + 0.0157i
   0.6600 + 0.0000i   0.2706 - 0.2495i   1.3162 + 0.0175i
   0.6700 + 0.0000i   0.2680 - 0.2554i   1.3347 + 0.0192i
   0.6800 + 0.0000i   0.2656 - 0.2612i   1.3533 + 0.0208i
   0.6900 + 0.0000i   0.2634 - 0.2671i   1.3720 + 0.0224i
   0.7000 + 0.0000i   0.2614 - 0.2731i   1.3909 + 0.0239i
   0.7100 + 0.0000i   0.2595 - 0.2791i   1.4100 + 0.0253i
   0.7200 + 0.0000i   0.2578 - 0.2851i   1.4292 + 0.0267i
   0.7300 + 0.0000i   0.2562 - 0.2912i   1.4485 + 0.0280i
   0.7400 + 0.0000i   0.2547 - 0.2974i   1.4680 + 0.0292i
   0.7500 + 0.0000i   0.2533 - 0.3037i   1.4876 + 0.0304i
   0.7600 + 0.0000i   0.2521 - 0.3100i   1.5073 + 0.0316i
   0.7700 + 0.0000i   0.2509 - 0.3164i   1.5272 + 0.0327i
   0.7800 + 0.0000i   0.2498 - 0.3229i   1.5472 + 0.0337i
   0.7900 + 0.0000i   0.2488 - 0.3295i   1.5673 + 0.0347i
   0.8000 + 0.0000i   0.2479 - 0.3361i   1.5876 + 0.0357i
   0.8100 + 0.0000i   0.2471 - 0.3428i   1.6080 + 0.0366i
   0.8200 + 0.0000i   0.2463 - 0.3497i   1.6285 + 0.0374i
   0.8300 + 0.0000i   0.2456 - 0.3566i   1.6491 + 0.0383i
   0.8400 + 0.0000i   0.2449 - 0.3635i   1.6698 + 0.0391i
   0.8500 + 0.0000i   0.2443 - 0.3706i   1.6907 + 0.0398i
   0.8600 + 0.0000i   0.2437 - 0.3778i   1.7117 + 0.0405i
   0.8700 + 0.0000i   0.2432 - 0.3850i   1.7328 + 0.0412i
   0.8800 + 0.0000i   0.2427 - 0.3923i   1.7541 + 0.0419i
   0.8900 + 0.0000i   0.2423 - 0.3997i   1.7754 + 0.0425i
   0.9000 + 0.0000i   0.2419 - 0.4072i   1.7969 + 0.0431i
   0.9100 + 0.0000i   0.2415 - 0.4147i   1.8185 + 0.0437i
   0.9200 + 0.0000i   0.2412 - 0.4224i   1.8402 + 0.0443i
   0.9300 + 0.0000i   0.2409 - 0.4301i   1.8621 + 0.0448i
   0.9400 + 0.0000i   0.2406 - 0.4379i   1.8841 + 0.0453i
   0.9500 + 0.0000i   0.2403 - 0.4458i   1.9061 + 0.0458i
   0.9600 + 0.0000i   0.2401 - 0.4538i   1.9284 + 0.0463i
   0.9700 + 0.0000i   0.2399 - 0.4618i   1.9507 + 0.0467i
   0.9800 + 0.0000i   0.2397 - 0.4699i   1.9732 + 0.0472i
   0.9900 + 0.0000i   0.2395 - 0.4781i   1.9957 + 0.0476i
   1.0000 + 0.0000i   0.2394 - 0.4864i   2.0185 + 0.0480i];

datwhamp =[
   0.1000 + 0.0000i   0.7654 - 0.0389i
   0.1100 + 0.0000i   0.7581 - 0.0498i
   0.1200 + 0.0000i   0.7445 - 0.0585i
   0.1300 + 0.0000i   0.7284 - 0.0604i
   0.1400 + 0.0000i   0.7165 - 0.0560i
   0.1500 + 0.0000i   0.7106 - 0.0504i
   0.1600 + 0.0000i   0.7092 - 0.0460i
   0.1700 + 0.0000i   0.7106 - 0.0432i
   0.1800 + 0.0000i   0.7138 - 0.0419i
   0.1900 + 0.0000i   0.7183 - 0.0417i
   0.2000 + 0.0000i   0.7237 - 0.0423i
   0.2100 + 0.0000i   0.7298 - 0.0433i
   0.2200 + 0.0000i   0.7364 - 0.0446i
   0.2300 + 0.0000i   0.7436 - 0.0460i
   0.2400 + 0.0000i   0.7512 - 0.0474i
   0.2500 + 0.0000i   0.7592 - 0.0487i
   0.2600 + 0.0000i   0.7676 - 0.0499i
   0.2700 + 0.0000i   0.7763 - 0.0509i
   0.2800 + 0.0000i   0.7854 - 0.0517i
   0.2900 + 0.0000i   0.7947 - 0.0524i
   0.3000 + 0.0000i   0.8044 - 0.0528i
   0.3100 + 0.0000i   0.8142 - 0.0529i
   0.3200 + 0.0000i   0.8244 - 0.0529i
   0.3300 + 0.0000i   0.8347 - 0.0526i
   0.3400 + 0.0000i   0.8453 - 0.0521i
   0.3500 + 0.0000i   0.8561 - 0.0514i
   0.3600 + 0.0000i   0.8670 - 0.0504i
   0.3700 + 0.0000i   0.8782 - 0.0493i
   0.3800 + 0.0000i   0.8897 - 0.0479i
   0.3900 + 0.0000i   0.9013 - 0.0463i
   0.4000 + 0.0000i   0.9132 - 0.0446i
   0.4100 + 0.0000i   0.9253 - 0.0426i
   0.4200 + 0.0000i   0.9377 - 0.0405i
   0.4300 + 0.0000i   0.9504 - 0.0382i
   0.4400 + 0.0000i   0.9633 - 0.0359i
   0.4500 + 0.0000i   0.9765 - 0.0334i
   0.4600 + 0.0000i   0.9900 - 0.0308i
   0.4700 + 0.0000i   1.0038 - 0.0281i
   0.4800 + 0.0000i   1.0179 - 0.0254i
   0.4900 + 0.0000i   1.0323 - 0.0227i
   0.5000 + 0.0000i   1.0470 - 0.0199i
   0.5100 + 0.0000i   1.0620 - 0.0171i
   0.5200 + 0.0000i   1.0773 - 0.0144i
   0.5300 + 0.0000i   1.0928 - 0.0117i
   0.5400 + 0.0000i   1.1086 - 0.0090i
   0.5500 + 0.0000i   1.1247 - 0.0064i
   0.5600 + 0.0000i   1.1410 - 0.0039i
   0.5700 + 0.0000i   1.1575 - 0.0014i
   0.5800 + 0.0000i   1.1743 + 0.0010i
   0.5900 + 0.0000i   1.1913 + 0.0033i
   0.6000 + 0.0000i   1.2085 + 0.0056i
   0.6100 + 0.0000i   1.2259 + 0.0078i
   0.6200 + 0.0000i   1.2434 + 0.0099i
   0.6300 + 0.0000i   1.2612 + 0.0119i
   0.6400 + 0.0000i   1.2792 + 0.0138i
   0.6500 + 0.0000i   1.2973 + 0.0157i
   0.6600 + 0.0000i   1.3156 + 0.0174i
   0.6700 + 0.0000i   1.3340 + 0.0191i
   0.6800 + 0.0000i   1.3526 + 0.0208i
   0.6900 + 0.0000i   1.3714 + 0.0223i
   0.7000 + 0.0000i   1.3903 + 0.0238i
   0.7100 + 0.0000i   1.4093 + 0.0253i
   0.7200 + 0.0000i   1.4285 + 0.0266i
   0.7300 + 0.0000i   1.4478 + 0.0279i
   0.7400 + 0.0000i   1.4673 + 0.0292i
   0.7500 + 0.0000i   1.4868 + 0.0304i
   0.7600 + 0.0000i   1.5066 + 0.0315i
   0.7700 + 0.0000i   1.5264 + 0.0326i
   0.7800 + 0.0000i   1.5464 + 0.0337i
   0.7900 + 0.0000i   1.5665 + 0.0347i
   0.8000 + 0.0000i   1.5867 + 0.0356i
   0.8100 + 0.0000i   1.6071 + 0.0366i
   0.8200 + 0.0000i   1.6276 + 0.0374i
   0.8300 + 0.0000i   1.6482 + 0.0383i
   0.8400 + 0.0000i   1.6689 + 0.0391i
   0.8500 + 0.0000i   1.6898 + 0.0398i
   0.8600 + 0.0000i   1.7108 + 0.0406i
   0.8700 + 0.0000i   1.7319 + 0.0413i
   0.8800 + 0.0000i   1.7531 + 0.0419i
   0.8900 + 0.0000i   1.7745 + 0.0426i
   0.9000 + 0.0000i   1.7960 + 0.0432i
   0.9100 + 0.0000i   1.8175 + 0.0438i
   0.9200 + 0.0000i   1.8393 + 0.0443i
   0.9300 + 0.0000i   1.8611 + 0.0449i
   0.9400 + 0.0000i   1.8831 + 0.0454i
   0.9500 + 0.0000i   1.9051 + 0.0459i
   0.9600 + 0.0000i   1.9274 + 0.0464i
   0.9700 + 0.0000i   1.9497 + 0.0468i
   0.9800 + 0.0000i   1.9721 + 0.0473i
   0.9900 + 0.0000i   1.9947 + 0.0477i];
%%
h=figure('unit','normalized','Position',[0.01 0.45 0.5 0.3],...
    'DefaultAxesFontSize',15);
subplot(121); hold on;
plot(datpdrk(:,1),real(datpdrk(:,2)),'go',...
    datpdrk(:,1),real(datpdrk(:,3)),'go','LineWidth',2);
hold on;
plot(datwhamp(:,1),real(datwhamp(:,2)),'rx',...
    'LineWidth',2);
hold on;
ylim([-0.05,2.5]);
grid on;box on;
xlabel('kc/\omega_{pi}'); ylabel('\omega_r/\omega_{ci}');
legend('pdrk-1','pdrk-2','whamp-1','whamp-2',...
    'location','northwest'); legend('boxoff');
title('benchmark \theta\neq0 beam mode');


subplot(122); hold on;
plot(datpdrk(:,1),imag(datpdrk(:,2)),'go',...
    datpdrk(:,1),imag(datpdrk(:,3)),'go','LineWidth',2);
hold on;
plot(datwhamp(:,1),imag(datwhamp(:,2)),'rx',...
    'LineWidth',2);
hold on;
ylim([-0.3,0.2]);
grid on;box on;
xlabel('kc/\omega_{pi}'); ylabel('\omega_i/\omega_{ci}');
title('\beta=1, k_\perp=0.5');


